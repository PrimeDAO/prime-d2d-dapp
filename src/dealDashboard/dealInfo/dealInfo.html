<template>
  <pcard>
    <h1 class="title heading heading3 gradient">Deal Information</h1>

    <hr>

    <div class="infoSection">
      <img class="daoLogo" src.bind="deal.primaryDao.logoURI">
      <div class="daoDetails" ptooltip.bind="deal.primaryDao.name">
        ${deal.primaryDao.name}
        <div class="daoSocialLinks">
          <a href.bind="socialMedia.url" repeat.for="socialMedia of deal.primaryDao.social_medias">
            <i class.bind="getSocialMediaDetails(socialMedia.name).icon"></i>
          </a>
        </div>
      </div>
      <span class="bodySmallTextBold">Primary DAO</span>
    </div>

    <hr if.bind="partnerDao">

    <div class="infoSection" if.bind="deal.partnerDao" ref="partnerDao">
      <img class="daoLogo" src.bind="deal.partnerDao.logoURI">
      <div class="daoDetails" ptooltip.bind="deal.partnerDao.name">
        ${deal.partnerDao.name}
        <div class="daoSocialLinks">
          <a href.bind="socialMedia.url"
            repeat.for="socialMedia of deal.partnerDao.social_medias"
            target="_blank">
            <i class.bind="getSocialMediaDetails(socialMedia.name).icon"></i>
          </a>
        </div>
      </div>
      <span class="bodySmallTextBold">Partner DAO</span>
    </div>

    <hr>

    <div class="infoSection">
      <span class="bodySmallTextBold infoTitle">Type</span>
      Token Swap
    </div>
    <div class="infoSection">
      <span class="bodySmallTextBold infoTitle">Total representatives</span>
      ${deal.representatives.size}
    </div>
    <div class="infoSection" if.bind="deal.isOpenProposal">
      <span class="bodySmallTextBold infoTitle">Deal Lead</span>
      <etherscanlink address.bind="deal.proposalLead.address"
        text="${deal.proposalLead.address | smallHexString}">
      </etherscanlink>
    </div>

    <hr if.bind="primaryFunds">

    <div class="infoSection" if.bind="deal.primaryDao.tokens.length" ref="primaryFunds">
      <div class="bodySmallTextBold infoTitle">Primary DAO Funds</div>
      <div>
        <div class="tokenDetails" repeat.for="tokenDetails of deal.primaryDao.tokens">
          <img class="daoSmallLogo" src.bind="tokenDetails.logoURI">
          <formatted-number mantissa="0" thousands-separated
            value.to-view="tokenDetails.amount | ethwei:tokenDetails.decimals"></formatted-number>
          ${tokenDetails.symbol}
        </div>
        <span class="bodySmallTextBold" if.bind="deal.primaryDao.tokens.length === 0">No tokens</span>
      </div>
    </div>

    <hr if.bind="partnerFunds">

    <div class="infoSection" if.bind="deal.partnerDao" ref="partnerFunds">
      <div class="bodySmallTextBold infoTitle">Partner DAO Funds</div>
      <div>
        <div class="tokenDetails" repeat.for="tokenDetails of deal.partnerDao.tokens">
          <img class="daoSmallLogo" src.bind="tokenDetails.logoURI">
          <formatted-number mantissa="0" thousands-separated
            value.to-view="tokenDetails.amount | ethwei:tokenDetails.decimals"></formatted-number>
          ${tokenDetails.symbol}
        </div>
      </div>
    </div>

    <hr if.bind="totalFunds || timeLeft">

    <div class="infoSection" if.bind="deal.primaryDao.tokens.length && deal.totalPrice" ref="totalFunds">
      <span class="bodySmallTextBold infoTitle">Total funds value</span>
      ${deal.totalPrice | currency}
    </div>

    <div class="infoSection" if.bind="deal.isFunding" ref="timeLeft">
      <span class="bodySmallTextBold infoTitle">Time left to execute</span>
      <span class="textRight">
        ${deal.timeLeftToExecute | timespan:"largest2"}
      </span>
    </div>

    <hr if.bind="privateDeal">

    <div class="infoSection" if.bind="deal.isPartnered" ref="privateDeal">
      <div class="bodySmallTextBold infoTitle">Private Deal</div>
      <span>
        <ptoggle
          disabled.bind="!deal.isUserProposalLead"
          ptooltip.bind="deal.isUserProposalLead ? '' : deal.isPrivate ? 'This deal is private' : 'This deal is public'"
          change.trigger="changePrivacy()"
          value.bind="deal.isPrivate"
        ></ptoggle>
      </span>
    </div>

  </pcard>
</template>
