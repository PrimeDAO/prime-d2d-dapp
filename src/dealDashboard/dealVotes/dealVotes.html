<template>
  <require from="./dealRepresentativesVotes/dealRepresentativesVotes"></require>

  <pcard>
    <div class="content">
      <h1 class="title heading heading3 gradient">Vote</h1>
      <p class="bodySmallText">
        ${statusText.voteText}
      </p>
      <pbutton-group if.bind="deal.representatives.has(ethereumService.defaultAccountAddress)">
        <pbutton
          class="${deal.representativeVote(ethereumService.defaultAccountAddress) === true ? 'acceptButtonActive' : ''}"
          full-width
          type="formfield"
          click.delegate="deal.vote(true)"
        >
          <i class="fas fa-check-circle"></i>
          ${deal.representativeVote(ethereumService.defaultAccountAddress) === true ? 'Accepted': 'Accept' }
        </pbutton>
        <pbutton
          class="${deal.representativeVote(ethereumService.defaultAccountAddress) === false ? 'declineButtonActive' : ''}"
          full-width
          type="formfield"
          click.delegate="deal.vote(false)"
        >
          <i class="fas fa-times-circle"></i>
          ${deal.representativeVote(ethereumService.defaultAccountAddress) === false ? 'Declined': 'Decline' }
        </pbutton>
      </pbutton-group>

      <div class="negotiate" if.bind="ethereumService.defaultAccountAddress">
        <pbutton type="tertiary" click.delegate="goToDiscussions()">
          <img src="/static/comment.svg" />
          Negotiate
        </pbutton>
      </div>

      <p class="bodySmallText votesSubtitle representativesVotesSubtitle">
        Votes (${deal.submittedVotes.length}/${deal.allRepresentatives.length})
      </p>
      <deal-representatives-votes deal.bind="deal" dao.bind="deal.primaryDao"></deal-representatives-votes>
      <deal-representatives-votes deal.bind="deal" dao.bind="deal.partnerDao"></deal-representatives-votes>

      <p class="bodySmallText votesSubtitle" if.bind="statusText">Deal status</p>
      <div class="orangeColor">${statusText.statusText}</div>
    </div>

    <div class="funding" if.bind="deal.majorityHasVoted && (deal.registrationData.proposalLead.address === ethereumService.defaultAccountAddress || !ethereumService.defaultAccountAddress)">
      <pbutton class="fundButton" click.delegate="fund()"
        if.bind="ethereumService.defaultAccountAddress" type="primary">
        Start Funding
        <i class="fas fa-arrow-right"></i>
      </pbutton>
      <pbutton click.delegate="ethereumService.ensureConnected()" if.bind="!ethereumService.defaultAccountAddress"
        type="primary">
        Connect Wallet
      </pbutton>
    </div>
  </pcard>
</template>
