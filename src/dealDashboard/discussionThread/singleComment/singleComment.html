<template>
  <div class="single comment">
    <header>
      <figure class="avatar">
        <img src="/genericToken.svg" alt="">
      </figure>
      <h3 if.bind="comment.author">${comment.author}</h3>
      <span if.bind="comment.author === author">(Author)</span>
      <time class="lastActivity">${niceDate(comment.createdOn).diff()}</time>
    </header>
    <main>
      <section if.bind="repliesTo" class="reply">
        <div>
          <figure>
            <img src="/genericToken.svg" alt="">
          </figure>
          <span>
            ${repliesTo.author | smallHexString} 
            <span if.bind="comment.author === author">(Author)</span>
          </span>
        </div>
        <p>
          ${repliesTo.text}
        </p>
      </section>
      ${comment.text}
    </main>
    <footer>
      <div if.bind="comment.author !== connectedAddress && isConnected" class="vote action">
        <pbutton type="tertiary" click.delegate="vote('toggleUpvote')"><i class="fas fa-thumbs-up"></i></pbutton>
        <pbutton type="tertiary" click.delegate="vote('toggleDownvote')"><i class="fas fa-thumbs-down"></i></pbutton>
        <pbutton type="tertiary" click.delegate="reply()">Reply&nbsp;<i class="fas fa-reply"></i></pbutton>
      </div>
      <div if.bind="loading !== 'isVoting ' + comment._id" class="vote count ${isConnected ? 'isConnected' : ''}">
        <div class="${voteDirection}Vote">
          <i class="fas fa-thumbs-${voteDirection === 'no'? 'up':voteDirection}"></i>
          ${voteDirection === 'down' ? -votes : votes}
        </div>
      </div>
      <div else class="vote count ${isConnected ? 'isConnected' : ''}">
        <div type="tertiary"><i class="fas fa-thumbs-up"></i> <i class="spinner fas fa-circle-notch"></i></div>
      </div>
      <div if.bind="comment.author === connectedAddress && isConnected" class="vote action">
        <pbutton type="tertiary" click.delegate="delete()">Delete</pbutton>
        <pbutton type="tertiary" disabled click.delegate="edit()">Edit</pbutton>
        <pbutton type="tertiary" click.delegate="reply()">Reply&nbsp;<i class="fas fa-reply"></i></pbutton>
      </div>
    </footer>
  </div>
</template>